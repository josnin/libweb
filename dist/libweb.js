(()=>{var l={ATTR_PREFIX:"@",ATTR_REPLACE:"data-on",VAR_PARSE:{start:"{",end:"}"}};var $=self=>{let fnEvents=m(self);fnEvents.forEach(fn=>{self.shadowRoot.querySelector(`${fn.query}`)[`${fn.event}`]=$event=>{eval(`self.${fn.fn.replaceAll("'$event'","$event")}`)}})},m=t=>{let r=[];return t.shadowRoot.querySelectorAll("*").forEach(n=>{for(let[s,a]of Object.entries(n.attributes))if(a.name.startsWith(l.ATTR_REPLACE)){let c={query:`[${a.name}]`,fn:a.value,event:a.name.split("-")[1]};r.push(c)}}),r},f={createEventListener:$,getEventsAttrFn:m};var x=(t,r,e,n)=>{let s=t.shadowRoot.querySelectorAll("*"),a={get:(c,i)=>c[i],set:(c,i,u)=>(s.forEach(o=>{o.type==="text"&&o.dataset.bind===i?o.value=u:(n.updateVarHTMLOnChange(o,c,i,u),n.updateVarAttrOnChange(o,i,u),e.createEventListener(t))}),c[i]=u,!0)};return new Proxy(r,a)},g={createReactive:x};var L=t=>{t.shadowRoot.querySelectorAll("[data-bind]").forEach(e=>{e.type==="text"&&e.addEventListener("input",n=>{t.__reactive[n.target.getAttribute("data-bind")]=n.target.value})})},E={addDataBindListener:L};var T=t=>t[0].replace(/[()]/g,""),b=(t,r,e)=>t.split(r)[1].split(e)[0],R=t=>isNaN(t)&&!t.startsWith("'")?`'${t}'`:t,P=t=>t.map(e=>R(e)),d={stripParenthesis:T,strip:b,addQuote:R,addQuoteItems:P};var S=(t,r)=>{for(let[e,n]of Object.entries(r.attributes)){let s=y(t,n.name,n.value);s&&(r.setAttribute(`data-${n.name.replace(l.ATTR_PREFIX,"on")}-${(+new Date).toString(36)}`,s),r.removeAttribute(`${n.name}`))}},V=(t,r)=>{r.innerHTML.split(" ").forEach(e=>{if(p(e)){let n=p(e)[0],s=d.strip(e,l.VAR_PARSE.start,l.VAR_PARSE.end),a=Array.from(t.attributes).find(i=>i.name===s),c=null;t[s]!=null?c=t[s]:t.__reactive[s]!=null?c=t.__reactive[s]:a&&(c=a.value),c&&(r.innerHTML=r.innerHTML.replaceAll(n,`${c}<!--${s}-->`))}})},w=(t,r,e,n)=>{t.innerHTML=t.innerHTML.replaceAll(`${r[e]}<!--${e}-->`,`${n}<!--${e}-->`)},_=t=>t.match(/\(.+\)/g),y=(t,r,e)=>{if(r.startsWith(l.ATTR_PREFIX)){let n=d.strip(_(e)[0],"(",")"),s=[],a=[],c=!0;if(n.split(",").forEach(i=>{let u="",o="";if(p(i)!=null?(u=p(i)[0],o=d.strip(u,l.VAR_PARSE.start,l.VAR_PARSE.end)):(u=i.trim(),o=i.trim()),parseInt(o))s.push(parseInt(o)),a.push(parseInt(u));else if(o.startsWith("'")||o==="$event")s.push(o),a.push(u);else if(t[o]!==void 0)s.push(t[o]),a.push(u);else if(t.__reactive[o]!==void 0)s.push(t.__reactive[o]),a.push(u);else if(t[o]===void 0&&t.__reactive[o]===void 0){console.warn(`event args ${o} unable to parse ${e}`),c=!1;return}}),c){let i=d.addQuoteItems(s);return i=`(${i})/*${a.join(",")}*/`,e.replaceAll(/\((.+)\)/g,`${i}`)}}},j=(t,r)=>{let e;return d.strip(t,"/*","*/").split(",").forEach((s,a)=>{s.startsWith(l.VAR_PARSE.start)&&s.endsWith(l.VAR_PARSE.end)&&r==d.strip(s,l.VAR_PARSE.start,l.VAR_PARSE.end)&&(e=a)}),e},H=t=>d.strip(_(t)[0],"(",")"),M=(t,r,e)=>{let n=[];return t.split(",").forEach((s,a)=>{a===r?n.push(d.addQuote(e)):n.push(s)}),n},O=(t,r,e)=>{for(let[n,s]of Object.entries(t.attributes))if(s.name.startsWith("data-on")&&s.value.includes(`{${r}}`)){let a=j(s.value,r),c=H(s.value),i=M(c,a,e),u=s.value.replaceAll(`${c}`,`${i}`);t.setAttribute(`${s.name}`,u)}},p=t=>t.match(/\{.+\}/g),W=t=>{t.shadowRoot.querySelectorAll("*").forEach(e=>{V(t,e),S(t,e)})},A={updateTemplate:W,updateVarHTMLOnChange:w,updateVarAttrOnChange:O};var h=class{constructor(r,e){this.makeReactive=n=>(E.addDataBindListener(this.self),g.createReactive(this.self,n,f,A)),this.self=r,this.self.attachShadow({mode:"open"}),this.self.shadowRoot.innerHTML=e,A.updateTemplate(this.self),f.createEventListener(this.self),this.self.__reactive=this.makeReactive(this.self.__reactive)}},v=class extends HTMLElement{constructor(){super()}connectedCallback(){let r=new h(this,this.__template)}},J={LibWeb:h,LWElement:v};})();
//# sourceMappingURL=libweb.js.map
